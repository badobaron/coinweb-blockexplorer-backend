{% extends 'template.html' %}

{% block title %}
<title>Coinweb Block Explorer</title>
{% endblock %}

{% block main %}
<div class="row">
    <div class="col l4 offset-l1 m10 offset-m1">
        <ul class="collection with-header">
            <li class="collection-header black white-text">
                Counterparty Stats
                <span class="badge white-text" id="transactions_number"></span>
            </li>
            <li class="collection-item">
                <table class="striped">
                    <tbody>
                    <tr>
                        <th class="grey lighten-1">Assets</th>
                        <td id="assets"></td>
                        <th class="grey lighten-1">Dividends</th>
                        <td id="dividends"></td>
                    </tr>
                    <tr>
                        <th>Bets</th>
                        <td id="bets"></td>
                        <th>Issuances</th>
                        <td id="issuances"></td>
                    </tr>
                    <tr>
                        <th class="grey lighten-1">Broadcasts</th>
                        <td id="broadcasts"></td>
                        <th class="grey lighten-1">Orders</th>
                        <td id="orders"></td>
                    </tr>
                    <tr>
                        <th>Burns</th>
                        <td id="burns"></td>
                        <th>Sends</th>
                        <td id="sends"></td>
                    </tr>
                    </tbody>
                </table>
            </li>
        </ul>
    </div>


    <div class="col l3 m5 offset-m1">
        <ul class="collection with-header">
            <li class="collection-header black white-text">Currency Information</li>
            <li class="collection-item">
                <table class="striped">
                    <tbody>
                    <tr>
                        <th class="grey lighten-1">MarketCap</th>
                        <td id="marketcap"></td>
                    </tr>
                    <tr>
                        <th>24h Volume</th>
                        <td id="24volume"></td>
                    </tr>
                    <tr>
                        <th class="grey lighten-1">USD Price</th>
                        <td id="usd"></td>
                    </tr>
                    <tr>
                        <th>BTC Price</th>
                        <td id="btc"></td>
                    </tr>
                    </tbody>
                </table>
            </li>
        </ul>
    </div>


    <div class="col l3 m5">
        <ul class="collection with-header">
            <li class="collection-header black white-text">Counterparty Stats</li>
            <li class="collection-item">
                <table class="striped">
                    <tbody>
                    <tr>
                        <th class="grey lighten-1">Block#</th>
                        <td id="block"></td>
                    </tr>
                    <tr>
                        <th>Unconfirmed</th>
                        <td id="unconfirmed"></td>
                    </tr>
                    <tr>
                        <th class="grey lighten-1">Low fee</th>
                        <td id="low_fee"></td>
                    </tr>
                    <tr>
                        <th>Optimal fee</th>
                        <td id="optimal_fee"></td>
                    </tr>
                    </tbody>
                </table>
            </li>
        </ul>
    </div>
</div>
<div class="row">
    <div class="col s12">
        <ul class="tabs  black tabs-transparent">
            <li class="tab col s3 m3 l3 xl3"><a class="active" href="#assets_table">Assets</a></li>
            <li class="tab col s3 m3 l3 xl3"><a href="#bets_table">Bets</a></li>
            <li class="tab col s3 m3 l3 xl3"><a href="#blocks_table">Blocks</a></li>
            <li class="tab col s3 m3 l3 xl3"><a href="#broadcasts_table">Broadcasts</a></li>
            <li class="tab col s3 m3 l3 xl3"><a href="#burns_table">Burns</a></li>
            <li class="tab col s3 m3 l3 xl3"><a href="#dividends_table">Dividends</a></li>
            <li class="tab col s3 m3 l3 xl3"><a href="#issuances_table">Issuances</a></li>
            <li class="tab col s3 m3 l3 xl3"><a href="#markets_table">Markets</a></li>
            <li class="tab col s3 m3 l3 xl3"><a href="#orders_table">Orders</a></li>
            <li class="tab col s3 m3 l3 xl3"><a href="#sends_table">Sends</a></li>
        </ul>
    </div>


    <!--Assets table-->
    <div id="assets_table" class="col s10 offset-s1">
        <div class="container">
            <div class="row center">
                <div class="col s12">
                    <ul class="collection with-header">
                        <li class="collection-header">
                            <h5>
                                <i class="material-icons left">storage</i>
                                All Assets
                                <span class="badge">72,000 results</span>
                            </h5>
                        </li>
                        <li class="collection-item">
                            <table class="highlight" id="assets_table_info">
                                <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Asset</th>
                                    <th>Asset Description</th>
                                    <th>Total Supply</th>
                                    <th>Divisible</th>
                                    <th>Locked</th>
                                </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </li>
                        <li class="collection-item">
                            <ul class="pagination center-align">
                                <li class="disabled"><a href="#!"><i class="material-icons">chevron_left</i></a></li>
                                <li class="active"><a href="#!">1</a></li>
                                <li class="waves-effect"><a href="#!">2</a></li>
                                <li class="waves-effect"><a href="#!">3</a></li>
                                <li class="waves-effect"><a href="#!">4</a></li>
                                <li class="waves-effect"><a href="#!">5</a></li>
                                <li class="waves-effect"><a href="#!"><i class="material-icons">chevron_right</i></a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>


    <!--Bets table-->
    <div id="bets_table" class="col s10 offset-s1">
        <div class="container">
            <div class="row center">
                <div class="col s12">
                    <ul class="collection with-header">
                        <li class="collection-header">
                            <h5>
                                <i class="material-icons left">storage</i>
                                Bets
                                <span class="badge">72,000 results</span>
                            </h5>
                        </li>
                        <li class="collection-item">
                            <table class="highlight" id="bets_table_info">
                                <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Block</th>
                                    <th>Time</th>
                                    <th>Source</th>
                                    <th>Feed</th>
                                    <th>Fee</th>
                                </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </li>
                        <li class="collection-item">
                            <ul class="pagination center-align">
                                <li class="disabled"><a href="#!"><i class="material-icons">chevron_left</i></a></li>
                                <li class="active"><a href="#!">1</a></li>
                                <li class="waves-effect"><a href="#!">2</a></li>
                                <li class="waves-effect"><a href="#!">3</a></li>
                                <li class="waves-effect"><a href="#!">4</a></li>
                                <li class="waves-effect"><a href="#!">5</a></li>
                                <li class="waves-effect"><a href="#!"><i class="material-icons">chevron_right</i></a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>


    <!--Blocks table-->
    <div id="blocks_table" class="col s10 offset-s1">
        <div class="container">
            <div class="row center">
                <div class="col s12">
                    <ul class="collection with-header">
                        <li class="collection-header">
                            <h5>
                                <i class="material-icons left">link</i>
                                Blocks
                                <span class="badge">72,000 results</span>
                            </h5>
                        </li>
                        <li class="collection-item">
                            <table class="highlight" id="blocks_table_info">
                                <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Block</th>
                                    <th>Hash</th>
                                    <th>Time</th>
                                </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </li>
                        <li class="collection-item">
                            <ul class="pagination center-align">
                                <li class="disabled"><a href="#!"><i class="material-icons">chevron_left</i></a></li>
                                <li class="active"><a href="#!">1</a></li>
                                <li class="waves-effect"><a href="#!">2</a></li>
                                <li class="waves-effect"><a href="#!">3</a></li>
                                <li class="waves-effect"><a href="#!">4</a></li>
                                <li class="waves-effect"><a href="#!">5</a></li>
                                <li class="waves-effect"><a href="#!"><i class="material-icons">chevron_right</i></a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>


    <!--Broadcasts-->
    <div id="broadcasts_table" class="col s10 offset-s1">
        <div class="container">
            <div class="row center">
                <div class="col s12">
                    <ul class="collection with-header">
                        <li class="collection-header">
                            <h5>
                                <i class="material-icons left">storage</i>
                                Broadcasts
                                <span class="badge">72,000 results</span>
                            </h5>
                        </li>
                        <li class="collection-item">
                            <table class="highlight" id="broadcasts_table_info">
                                <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Block</th>
                                    <th>Time</th>
                                    <th>Source</th>
                                    <th>Message</th>
                                    <th>Value</th>
                                    <th>Fee</th>
                                </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </li>
                        <li class="collection-item">
                            <ul class="pagination center-align">
                                <li class="disabled"><a href="#!"><i class="material-icons">chevron_left</i></a></li>
                                <li class="active"><a href="#!">1</a></li>
                                <li class="waves-effect"><a href="#!">2</a></li>
                                <li class="waves-effect"><a href="#!">3</a></li>
                                <li class="waves-effect"><a href="#!">4</a></li>
                                <li class="waves-effect"><a href="#!">5</a></li>
                                <li class="waves-effect"><a href="#!"><i class="material-icons">chevron_right</i></a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>


    <!--Burns-->
    <div id="burns_table" class="col s10 offset-s1">
        <div class="container">
            <div class="row center">
                <div class="col s12">
                    <ul class="collection with-header">
                        <li class="collection-header">
                            <h5>
                                <i class="material-icons left">storage</i>
                                Burns
                                <span class="badge">72,000 results</span>
                            </h5>
                        </li>
                        <li class="collection-item">
                            <table class="highlight" id="burns_table_info">
                                <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Block</th>
                                    <th>Time</th>
                                    <th>Source</th>
                                    <th>BTC Burned</th>
                                    <th>XCP Earned</th>
                                </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </li>
                        <li class="collection-item">
                            <ul class="pagination center-align">
                                <li class="disabled"><a href="#!"><i class="material-icons">chevron_left</i></a></li>
                                <li class="active"><a href="#!">1</a></li>
                                <li class="waves-effect"><a href="#!">2</a></li>
                                <li class="waves-effect"><a href="#!">3</a></li>
                                <li class="waves-effect"><a href="#!">4</a></li>
                                <li class="waves-effect"><a href="#!">5</a></li>
                                <li class="waves-effect"><a href="#!"><i class="material-icons">chevron_right</i></a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>


    <!--Dividends-->
    <div id="dividends_table" class="col s10 offset-s1">
        <div class="container">
            <div class="row center">
                <div class="col s12">
                    <ul class="collection with-header">
                        <li class="collection-header">
                            <h5>
                                <i class="material-icons left">storage</i>
                                Dividends
                                <span class="badge">72,000 results</span>
                            </h5>
                        </li>
                        <li class="collection-item">
                            <table class="highlight" id="dividends_table_info">
                                <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Block</th>
                                    <th>Time</th>
                                    <th>Source</th>
                                    <th>Asset</th>
                                    <th>Dividend Asset</th>
                                    <th>Quantity Per Unit</th>
                                </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </li>
                        <li class="collection-item">
                            <ul class="pagination center-align">
                                <li class="disabled"><a href="#!"><i class="material-icons">chevron_left</i></a></li>
                                <li class="active"><a href="#!">1</a></li>
                                <li class="waves-effect"><a href="#!">2</a></li>
                                <li class="waves-effect"><a href="#!">3</a></li>
                                <li class="waves-effect"><a href="#!">4</a></li>
                                <li class="waves-effect"><a href="#!">5</a></li>
                                <li class="waves-effect"><a href="#!"><i class="material-icons">chevron_right</i></a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>


    <!--Issuances-->
    <div id="issuances_table" class="col s10 offset-s1">
        <div class="container">
            <div class="row center">
                <div class="col s12">
                    <ul class="collection with-header">
                        <li class="collection-header">
                            <h5>
                                <i class="material-icons left">storage</i>
                                Issuances
                                <span class="badge">72,000 results</span>
                            </h5>
                        </li>
                        <li class="collection-item">
                            <table class="highlight" id="issuances_table_info">
                                <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Block</th>
                                    <th>Time</th>
                                    <th>Asset</th>
                                    <th>Quantity</th>
                                    <th>Locked</th>
                                    <th>Transfer</th>
                                    <th>Fee</th>
                                </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </li>
                        <li class="collection-item">
                            <ul class="pagination center-align">
                                <li class="disabled"><a href="#!"><i class="material-icons">chevron_left</i></a></li>
                                <li class="active"><a href="#!">1</a></li>
                                <li class="waves-effect"><a href="#!">2</a></li>
                                <li class="waves-effect"><a href="#!">3</a></li>
                                <li class="waves-effect"><a href="#!">4</a></li>
                                <li class="waves-effect"><a href="#!">5</a></li>
                                <li class="waves-effect"><a href="#!"><i class="material-icons">chevron_right</i></a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>


    <!--TODO add markets-->
    <!--Markets-->
    <div id="markets_table" class="col s10 offset-s1"><p>Markets</p></div>


    <!--Orders-->
    <div id="orders_table" class="col s10 offset-s1">
        <div class="container">
            <div class="row center">
                <div class="col s12">
                    <ul class="collection with-header">
                        <li class="collection-header">
                            <h5>
                                <i class="material-icons left">storage</i>
                                Orders
                                <span class="badge">72,000 results</span>
                            </h5>
                        </li>
                        <li class="collection-item">
                            <table class="highlight" id="orders_table_info">
                                <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Block</th>
                                    <th>Time</th>
                                    <th>Market</th>
                                    <th>Buying</th>
                                    <th>Selling</th>
                                </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </li>
                        <li class="collection-item">
                            <ul class="pagination center-align">
                                <li class="disabled"><a href="#!"><i class="material-icons">chevron_left</i></a></li>
                                <li class="active"><a href="#!">1</a></li>
                                <li class="waves-effect"><a href="#!">2</a></li>
                                <li class="waves-effect"><a href="#!">3</a></li>
                                <li class="waves-effect"><a href="#!">4</a></li>
                                <li class="waves-effect"><a href="#!">5</a></li>
                                <li class="waves-effect"><a href="#!"><i class="material-icons">chevron_right</i></a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>


    <!--Sends-->
    <div id="sends_table" class="col s10 offset-s1">
        <div class="container">
            <div class="row center">
                <div class="col s12">
                    <ul class="collection with-header">
                        <li class="collection-header">
                            <h5>
                                <i class="material-icons left">storage</i>
                                Sends
                                <span class="badge">72,000 results</span>
                            </h5>
                        </li>
                        <li class="collection-item">
                            <table class="highlight" id="sends_table_info">
                                <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Block</th>
                                    <th>Time</th>
                                    <th>Asset</th>
                                    <th>Quantity</th>
                                    <th>Destination</th>
                                </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </li>
                        <li class="collection-item">
                            <ul class="pagination center-align">
                                <li class="disabled"><a href="#!"><i class="material-icons">chevron_left</i></a></li>
                                <li class="active"><a href="#!">1</a></li>
                                <li class="waves-effect"><a href="#!">2</a></li>
                                <li class="waves-effect"><a href="#!">3</a></li>
                                <li class="waves-effect"><a href="#!">4</a></li>
                                <li class="waves-effect"><a href="#!">5</a></li>
                                <li class="waves-effect"><a href="#!"><i class="material-icons">chevron_right</i></a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}


{% block scripts%}
<!--Make tabs using materialize-->
<script>
    $(document).ready(function () {
        $('.tabs').tabs();
    });

    //add .format function
    String.prototype.format = function () {
        var args = [].slice.call(arguments);
        return this.replace(/(\{\d+\})/g, function (a) {
            return args[+(a.substr(1, a.length - 2)) || 0];
        });
    };

    //add function which shorten str and change end of str with ...
    String.prototype.trunc = String.prototype.trunc ||
        function (n) {
            return (this.length > n) ? this.substr(0, n - 1) + '&hellip;' : this;
        };

    var per_page = 10;
</script>

<script>
    //add .format function
    String.prototype.format = function () {
        var args = [].slice.call(arguments);
        return this.replace(/(\{\d+\})/g, function (a) {
            return args[+(a.substr(1, a.length - 2)) || 0];
        });
    };


    //request to the server
    $.ajax({
        url: '/indexInfo',
        type: 'POST',
        contentType: 'application/json;charset=UTF-8',
        data: JSON.stringify({}, null, '\t'),
        success: function (response) {
            response = JSON.parse(response);

//Fill 'counterparty stats' table with data
//TODO: how to get assets quantity
            $('#transactions_number').text(response['transactions'].toLocaleString('en') + ' Transactions');
// $('#assets').text(response['bets'].toLocaleString('en'));
            $('#bets').text(response['bets'].toLocaleString('en'));
            $('#broadcasts').text(response['broadcasts'].toLocaleString('en'));
            $('#burns').text(response['burns'].toLocaleString('en'));
            $('#dividends').text(response['dividends'].toLocaleString('en'));
            $('#issuances').text(response['issuances'].toLocaleString('en'));
            $('#orders').text(response['orders'].toLocaleString('en'));
            $('#sends').text(response['sends'].toLocaleString('en'));


//Fill 'currency information' table with data


//Fill 'counterparty stats' table with data
            $('#block').text(response['block_index'].toLocaleString('en'));


// var default_string = "<td>{0}</td><td>{1}</td><td>{2}</td><td>{3}</td><td>{4}</td><td>{5}</td>";
// var my_table = $("#bets").find('tbody')
// response.slice(0, per_page).forEach(function (bet, i, response) {
//     my_table.append($('<tr>')
//         .append(default_string.format(i + 1, bet['block_index'], '?', bet['source'], bet['feed_address'], (bet['fee_fraction_int'] / 1000000).toFixed(2) + '%'))
//     );
// })
        }
    })
</script>

<!--Fill tables-->

<script>
    //Fill ASSETS table
    $.ajax({
        url: '/assetsAll',
        type: 'POST',
        contentType: 'application/json;charset=UTF-8',
        data: JSON.stringify({'per_page': per_page}, null, '\t'),
        success: function (response) {
            response = JSON.parse(response);
            var default_string = "<td>{0}</td><td>{1}</td><td>{2}</td><td>{3}</td><td>{4}</td><td>{5}</td>";
            var my_table = $("#assets_table_info").find('tbody');
            response.slice(0, per_page).forEach(function (asset, i, response) {
                my_table.append($('<tr>')
                    .append(default_string.format(i + 1, asset['asset'], asset['description'], (asset['supply'] / 100000000).toFixed(9), asset['divisible'], asset['locked']))
                );
            })
        }
    })
</script>

<script>
    //Fill BLOCKS table

    //request to the server
    $.ajax({
        url: '/blocksAll',
        type: 'POST',
        contentType: 'application/json;charset=UTF-8',
        data: JSON.stringify({'per_page': per_page}, null, '\t'),
        success: function (response) {
            response = JSON.parse(response);
            var default_string = "<td>{0}</td><td>{1}</td><td>{2}</td><td>{3}</td>";
            var my_table = $("#blocks_table_info").find('tbody');
            response.slice(0, per_page).forEach(function (bet, i, response) {
                my_table.append($('<tr>')
                    .append(default_string.format(i + 1, bet['block_index'], bet['block_hash'], bet['time'])))
            })
        }
    })
</script>

<script>
    //Fill BROADCASTS table
    $.ajax({
        url: '/broadcastsAll',
        type: 'POST',
        contentType: 'application/json;charset=UTF-8',
        data: JSON.stringify({'per_page': per_page}, null, '\t'),
        success: function (response) {
            response = JSON.parse(response);
            console.log(response);
            var default_string = "<td>{0}</td><td>{1}</td><td>{2}</td><td>{3}</td><td>{4}</td><td>{5}</td><td>{6}</td>";
            var my_table = $("#broadcasts_table_info").find('tbody');
            response.slice(0, per_page).forEach(function (broadcast, i, response) {
                my_table.append($('<tr>')
                    .append(default_string.format(i + 1, broadcast['block_index'], broadcast['time'], broadcast['source'], broadcast['text'].trunc(39), broadcast['value'], (broadcast['fee_fraction_int'] / 1000000).toFixed(2) + '%'))
                );
            })
        }
    })
</script>

<script>
    //Fill BURNS table
    $.ajax({
        url: '/burnsAll',
        type: 'POST',
        contentType: 'application/json;charset=UTF-8',
        data: JSON.stringify({'per_page': per_page}, null, '\t'),
        success: function (response) {
            response = JSON.parse(response);
            var default_string = "<td>{0}</td><td>{1}</td><td>{2}</td><td>{3}</td><td>{4}</td><td>{5}</td>";
            var my_table = $("#burns_table_info").find('tbody');
            response.slice(0, per_page).forEach(function (burn, i, response) {
                my_table.append($('<tr>')
                    .append(default_string.format(i + 1, burn['block_index'], '?', burn['source'], (burn['burned'] / 100000000).toFixed(9), (burn['earned'] / 100000000).toFixed(9)))
                );
            })
        }
    })
</script>

<script>
    //Fill DIVIDENDS table
    $.ajax({
        url: '/dividendsAll',
        type: 'POST',
        contentType: 'application/json;charset=UTF-8',
        data: JSON.stringify({'per_page': per_page}, null, '\t'),
        success: function (response) {
            response = JSON.parse(response);
            var default_string = "<td>{0}</td><td>{1}</td><td>{2}</td><td>{3}</td><td>{4}</td><td>{5}</td><td>{6}</td>";
            var my_table = $("#dividends_table_info").find('tbody');
            response.slice(0, per_page).forEach(function (dividend, i, response) {
                my_table.append($('<tr>')
                    .append(default_string.format(i + 1, dividend['block_index'], '?', dividend['source'], dividend['asset'], dividend['dividend_asset'], (dividend['quantity_per_unit'] / 100000000).toFixed(9)))
                );
            })
        }
    })
</script>

<script>
    //Fill ISSUANCES table
    $.ajax({
        url: '/issuancesAll',
        type: 'POST',
        contentType: 'application/json;charset=UTF-8',
        data: JSON.stringify({'per_page': per_page}, null, '\t'),
        success: function (response) {
            response = JSON.parse(response);
            var default_string = "<td>{0}</td><td>{1}</td><td>{2}</td><td>{3}</td><td>{4}</td><td>{5}</td><td>{6}</td><td>{7}</td>";
            var my_table = $("#issuances_table_info").find('tbody');
            response.slice(0, per_page).forEach(function (issuance, i, response) {
                my_table.append($('<tr>')
                    .append(default_string.format(i + 1, issuance['block_index'], '?', issuance['asset'], (issuance['quantity'] / 100000000).toFixed(9), !!issuance['locked'], !!issuance['transfer'], (issuance['fee_paid'] / 100000000).toFixed(9)))
                );
            })
        }
    })
</script>

<script>
    //Fill ORDERS table
    $.ajax({
        url: '/ordersAll',
        type: 'POST',
        contentType: 'application/json;charset=UTF-8',
        data: JSON.stringify({'per_page': per_page}, null, '\t'),
        success: function (response) {
            response = JSON.parse(response);
            var default_string = "<td>{0}</td><td>{1}</td><td>{2}</td><td>{3}</td><td>{4}</td><td>{5}</td>";
            var my_table = $("#orders_table_info").find('tbody');
            response.slice(0, per_page).forEach(function (order, i, response) {
                my_table.append($('<tr>')
                    /*
                    {0} #
                    {1} block_index
                    {2} time
                    {3} get_asset + '/' + give_asset
                    {4} (get_quantity/100000000 if get_quantity.length >=7 else get_quantity) + ' ' + get_asset
                    {5} (give_quantity/100000000 if give_quantity.length >=7 else give_quantity) + ' ' + give_asset
                    I add if statements in {4} and {5}, because give_quantity and get_quantity are given in different
                    dimensions, so some low cost currencies may be represented incorrectly.
                    Example: give_quantity: 1000000000 BitCrystals
                    will be represented like 1000000000 but must be like 10 BitCrystals.

                    There may be bugs with this idea so there must be more smarter way how to deal with this.
                    */
                        .append(default_string.format(i + 1, order['block_index'], '?', order['get_asset'] + '/' + order['give_asset'], (order['get_quantity'].toString().length >= 7 ? (order['get_quantity'] / 100000000).toFixed(9) : order['get_quantity']) + ' ' + order['get_asset'], (order['give_quantity'].toString().length >= 7 ? (order['give_quantity'] / 100000000).toFixed(9) : order['give_quantity']) + ' ' + order['give_asset']))
                );
            })
        }
    })
</script>

<script>
    //Fill SENDS table
    $.ajax({
        url: '/sendsAll',
        type: 'POST',
        contentType: 'application/json;charset=UTF-8',
        data: JSON.stringify({'per_page': per_page}, null, '\t'),
        success: function (response) {
            response = JSON.parse(response);
            var default_string = "<td>{0}</td><td>{1}</td><td>{2}</td><td>{3}</td><td>{4}</td><td>{5}</td>";
            var my_table = $("#sends_table_info").find('tbody');
            response.slice(0, per_page).forEach(function (send, i, response) {
                my_table.append($('<tr>')
                    /*
                    {0} #
                    {1} block_index
                    {2} time
                    {3} asset
                    {4} (quantity/100000000 if quantity.length >=7 else quantity)
                    {5} destination
                    I add if statements in {4}, because quantities are given in different
                    dimensions, so some low cost currencies may be represented incorrectly.
                    Example: give_quantity: 1000000000 BitCrystals
                    will be represented like 1000000000 but must be like 10 BitCrystals.

                    There may be bugs with this idea so there must be more smarter way how to deal with this.
                    */
                        .append(default_string.format(i + 1, send['block_index'], '?', send['asset'], (send['quantity'].toString().length>=7?(send['quantity'] / 100000000).toFixed(9):send['quantity']), send['destination']))
                );
            })
        }
    })
</script>

{% endblock %}